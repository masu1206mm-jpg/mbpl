<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>えむびーてぃーあいPlus | </title>
  <style>
    /* CSSは全て変更なし */
    :root { --bg: #05070a; --accent-p: #ff7ca7; --accent-v: #bda6ff; --accent-b: #6ef2ff; --text: #ffffff; }
    * { box-sizing: border-box; }
    body { margin: 0; min-height: 100vh; font-family: "Hiragino Kaku Gothic ProN", sans-serif; background: var(--bg); color: var(--text); display: flex; justify-content: center; align-items: center; padding: 15px; overflow-x: hidden; }
    .container { max-width: 600px; width: 100%; transition: 0.5s; }
    .card { background: rgba(255,255,255,0.06); border-radius: 32px; padding: 25px; backdrop-filter: blur(20px); border: 1px solid rgba(255,255,255,0.1); box-shadow: 0 20px 50px rgba(0,0,0,0.5); }
    .extreme-mode { background: #000 !important; border: 2px solid #ff4477 !important; animation: shake 0.5s infinite; }
    @keyframes shake { 0%, 100% { transform: translate(0,0); } 25% { transform: translate(1px,-1px); } 75% { transform: translate(-1px,1px); } }
    h1 { text-align: center; font-size: 1.5rem; background: linear-gradient(90deg, var(--accent-p), var(--accent-v)); -webkit-background-clip: text; color: transparent; margin-bottom: 20px; font-weight: 900; }
    .progress-bar { height: 4px; background: rgba(255,255,255,0.1); border-radius: 2px; margin: 15px 0; overflow: hidden; }
    .progress-fill { height: 100%; background: var(--accent-b); width: 0%; transition: 0.3s; }
    .question-text { font-size: 1.1rem; font-weight: bold; line-height: 1.6; min-height: 70px; margin-bottom: 25px; text-align: center; }
    .choices { display: grid; gap: 12px; }
    button { padding: 16px; border-radius: 16px; border: 1px solid rgba(255,255,255,0.2); background: rgba(255,255,255,0.05); color: #fff; font-size: 0.95rem; font-weight: bold; cursor: pointer; transition: 0.2s; width: 100%; text-align: left; }
    button:active { transform: scale(0.98); background: rgba(255,255,255,0.1); }
    .timer { font-size: 4rem; text-align: center; color: #ff4477; font-weight: 900; margin-bottom: 10px; font-family: monospace; text-shadow: 0 0 20px #ff4477; }
    .res-area-name { font-size: 1.8rem; font-weight: 900; color: var(--accent-p); text-align:center; margin-bottom: 5px; }
    .res-type-name { font-size: 1rem; color: var(--accent-v); text-align: center; margin-bottom: 20px; font-weight: bold; }
    .section { background: rgba(255,255,255,0.04); border-radius: 20px; padding: 20px; margin-bottom: 15px; border-left: 4px solid var(--accent-v); }
    .sec-title { font-weight: 900; color: var(--accent-v); margin-bottom: 10px; font-size: 0.9rem; }
    .essay-text { line-height: 1.8; font-size: 0.9rem; white-space: pre-wrap; }
    .final-box { background: #111; border: 2px solid #ff4477; padding: 20px; border-radius: 20px; margin-top: 20px; line-height: 1.7; font-size: 0.9rem; }
    .hide { display: none !important; }
    .sub-btn { background: transparent; border: 1px solid #444; color: #888; padding: 10px; font-size: 0.7rem; margin-top: 20px; border-radius: 12px; text-align: center; width: auto; flex: 1; }
  </style>
</head>
<body>

<div class="container">
  <div id="screen-intro" class="card">
    <h1>えむびーてぃーあいPlus</h1>
    <p style="text-align:center; color:#bbb; font-size:0.9rem; line-height:1.6;">
      どこかの診断のような曖昧で無駄な5択質問を取り除き<br>
      具体化されたよりわかりやすい3択×100問で<br>
      あなたの思考パターンを徹底分析します
    </p>
    <button style="background:#fff; color:#000; margin-top:20px; text-align:center;" onclick="start(false)">診断を開始</button>
    <button id="resume-btn" class="hide" style="width:100%; margin-top:10px; border:1px solid #666; background:none; color:#fff; border-radius:16px; padding:16px; text-align:center;" onclick="start(true)">続きから再開</button>
  </div>

  <div id="screen-quiz" class="card hide">
    <div id="timer-ui" class="hide"><div id="timer-display" class="timer">45</div></div>
    <div style="font-size:0.8rem; color:var(--accent-b);">Q.<span id="q-num">1</span> / 100</div>
    <div class="progress-bar"><div id="progress-fill" class="progress-fill"></div></div>
    <div id="question-text" class="question-text"></div>
    <div id="choices" class="choices"></div>
    <div style="display:flex; gap:10px; width:100%;">
        <button class="sub-btn" onclick="goBack()">戻る</button>
        <button id="force-finish-btn" class="sub-btn" onclick="forceFinish()">途中で結果を見る</button>
        <button class="sub-btn" onclick="resetAll()">リセット</button>
    </div>
  </div>

  <div id="screen-result" class="card hide">
    <div id="res-area" class="res-area-name"></div>
    <div id="res-type" class="res-type-name"></div>
    
    <div class="section"><div class="sec-title">深層思考パターン</div><div id="res-thinking" class="essay-text"></div></div>
    <div class="section"><div class="sec-title">特有の恋愛傾向</div><div id="res-love" class="essay-text"></div></div>
    <div class="section"><div class="sec-title">天職となる仕事</div><div id="res-job-yes" class="essay-text"></div></div>
    <div class="section"><div class="sec-title">避けるべき環境</div><div id="res-job-no" class="essay-text"></div></div>
    <div class="section"><div class="sec-title">自己超越への道</div><div id="res-levelup" class="essay-text"></div></div>

    <div id="final-box" class="final-box"></div>
    <button style="margin-top:20px; text-align:center;" onclick="resetAll()">トップへ戻る</button>
  </div>
</div>

<script>
// DBは変更なし
const DB = [
  // SNS (1-20)
  {cat:"SNS", q:"TikTokやX等でバズってる人を見ると、いいね数やコメント数を気にしてしまう", c:["つい数字を分析してしまう", "たまに見てしまう", "全く気にならない"]},
  {cat:"SNS", q:"友達の投稿が伸びていると、コメント欄やいいね数を全て確認する", c:["誰が反応してるか隅々まで見る", "少し覗く程度", "見ない"]},
  {cat:"SNS", q:"1ヶ月に１回は使用するインスタアカウントが3つ以上ある", c:["ある", "2個", "1個"]},
  {cat:"SNS", q:"炎上してる話題を一から調べて追う癖がある", c:["経緯をすべて把握したい", "たまに追いかける", "時間の無駄だと思う"]},
  {cat:"SNS", q:"ストーリーを上げた後、友達からの反応をずっと待っている", c:["通知が来るまで何度も開く", "たまにチェックする", "放置している"]},
  {cat:"SNS", q:"投稿する前に何回も文章や写真を見直す", c:["1ミリのミスも許さず見直す", "数回は確認する", "勢いで上げる"]},
  {cat:"SNS", q:"反応が少ないと投稿を消したくなる", c:["恥ずかしくて消す", "少し落ち込む", "そのままにする"]},
  {cat:"SNS", q:"自撮りを上げる事がある", c:["自信がある時や加工が盛れたら", "たまに", "絶対上げない"]},
  {cat:"SNS", q:"フォロワー数で人を判断してしまうことがある", c:["数字＝その人の格だと思う", "少しは意識する", "中身で判断する"]},
  {cat:"SNS", q:"友達の幸せな報告には嫉妬することが多い", c:["正直、素直に喜べない", "少しモヤっとする", "全力で祝える"]},
  {cat:"SNS", q:"スマホを1日６時間以上操作する", c:["する", "６時間以内", "触らない日もある"]},
  {cat:"SNS", q:"SNSでの自分の立ち位置を意識している", c:["キャラ設定や見られ方を守る", "少しは気にする", "素のままでいる"]},
  {cat:"SNS", q:"承認されていないと不安になる", c:["誰かに認められないと価値がない", "たまに寂しくなる", "自分だけで満足"]},
  {cat:"SNS", q:"裏垢やコメント欄でニュースやその話題に対して自分の意見を良くいう", c:["匿名なら本音をぶつけられる", "たまに書き込む", "見るだけ"]},
  {cat:"SNS", q:"炎上している人を見て「自分ならこうする」と考える", c:["最善の火消し案が浮かぶ", "少し考える", "バカだなと思う"]},
  {cat:"SNS", q:"1ヶ月に２回以上はインスタの投稿を整理する", c:["２回以上整理する", "1ヶ月に1回はする", "気がむいたらする"]},
  {cat:"SNS", q:"TikTokライブやインスタライブ、、twitch、ツイキャスなどのライブ配信をしたことがある", c:["1回以上ある", "してみたいけどない", "やる気もない"]},
  {cat:"SNS", q:"有名人に「好きです」などのdmを送った事がある", c:["想いを伝えたくて送った", "送ろうとしたことはある", "ない"]},
  {cat:"SNS", q:"他人の投稿に批判的なコメントをした事がある", c:["間違っているから指摘した", "書いた", "ない"]},
  {cat:"SNS", q:"SNSはいかにいいねをたくさん貰うかが重要だ", c:["数字こそが正義", "どちらかといえば多い方がいい", "自己満足でいい"]},

  // GLAM (21-40)
  {cat:"GLAM", q:"見た目はお金でどうにかなる", c:["投資すれば必ず報われる", "ある程度はそう思う", "中身や素材が大事"]},
  {cat:"GLAM", q:"ここ1年は容姿を磨くことに1番お金をかけている", c:["美容が人生の最優先", "かなり使っている", "わすれた"]},
  {cat:"GLAM", q:"可愛い・かっこいいと言われると自信が出る", c:["それが生きる糧", "素直に嬉しい", "どうでも良い"]},
  {cat:"GLAM", q:"第一印象で損したくない", c:["外見でナメられたら終わり", "身だしなみは、、", "愛嬌があればいい"]},
  {cat:"GLAM", q:"ナメられたくない気持ちが強い", c:["強い", "普通", "どう思われてもいい"]},
  {cat:"GLAM", q:"整形は努力だと思う", c:["痛みと金をかける立派な努力", "一つの手段だと思う", "努力とは違う"]},
  {cat:"GLAM", q:"恋愛において自分の価値は高いと思う", c:["自分を安売りしたくない", "普通だと思う", "自信がない"]},
  {cat:"GLAM", q:"10万円以上のブランド品を複数所持している", c:["武装するために必要", "いくつか持っている", "興味がない"]},
  {cat:"GLAM", q:"メイクが上手く行かなくて遅刻した事がある", c:["完璧じゃない顔で外に出れない", "たまにある", "メイクより時間優先"]},
  {cat:"GLAM", q:"自分を安売りしても欲しいものがある", c:["目的のためなら手段を選ばない", "少しは譲歩する", "プライドは捨てない"]},
  {cat:"GLAM", q:"自分よりブサイクをみると安心する", c:["正直、優越感に浸る", "無意識に比較する", "何とも思わない"]},
  {cat:"GLAM", q:"整形をしている", c:["既にアップデート済み", "検討中・カウンセリング済み", "するつもりはない"]},
  {cat:"GLAM", q:"異性とのご飯は奢られたい", c:["相手が奢るべき", "割り勘", "奢りたい"]},
  {cat:"GLAM", q:"鏡を見てコンプレックスを感じる", c:["もっと直したい場所ばかり", "たまに気になる", "気にならない"]},
  {cat:"GLAM", q:"毎月記念日は祝ってほしい", c:["祝ってもらわないと無理", "余裕があれば", "いらない"]},
  {cat:"GLAM", q:"自分を高く見せるのは悪いことじゃない", c:["セルフブランディングの基本", "たまには必要", "ありのままがいい"]},
  {cat:"GLAM", q:"恋愛は女性は顔と男性はお金だと思う", c:["それがこの世の真理", "一理あると思う", "愛が一番"]},
  {cat:"GLAM", q:"他人にどう見られているか常に気になる", c:["360度どこから見られても良くいたい", "多少は気になる", "気にしない"]},
  {cat:"GLAM", q:"自分を下げる発言は冗談でも、言われたら傷つく", c:["絶対許さない", "モヤっとする", "笑いに変えれる"]},
  {cat:"GLAM", q:"プライドは高い方だ", c:["高い", "普通", "低い"]},

  // GACHI (41-60)
  {cat:"GACHI", q:"約束の時間は絶対守るべきだ", c:["5分前行動が当たり前", "できるだけ時間は守るようにしている", "別に守らなくて良い"]},
  {cat:"GACHI", q:"計画通りに進まないとイライラする", c:["予定が狂うとパニック・怒り", "少し焦る", "臨機応変に楽しむ"]},
  {cat:"GACHI", q:"ミスをすると原因を考える", c:["再発防止を徹底的に分析", "反省する", "次から気をつける"]},
  {cat:"GACHI", q:"学校や会社での人の小さな言い間違いを訂正したくなる", c:["正しくないのが気持ち悪い", "たまに指摘する", "スルーする"]},
  {cat:"GACHI", q:"自分は信号無視をするタイプだ", c:["青になるまで絶対待つ", "たまに無視", "危なくなければ渡る"]},
  {cat:"GACHI", q:"好きな人との夜ご飯は予約してて欲しい／したい", c:["段取りこそが誠意", "あれば嬉しい", "行き当たりばったりがいい"]},
  {cat:"GACHI", q:"段取りができていないと不安になる", c:["全行程を把握したい", "少し不安", "どうにかなる"]},
  {cat:"GACHI", q:"無責任な行動を見ると腹が立つ", c:["社会人・人間として許せない", "イラっとする", "人は人だと思う"]},
  {cat:"GACHI", q:"先のことを考えて動くタイプだ", c:["常にリスクヘッジを欠かさない", "普通に考える", "今が楽しければいい"]},
  {cat:"GACHI", q:"LINEでの誤字、脱字などの小さいミスが気になる", c:["送信前に何度も読み直す", "少し気になる", "気にせず送る"]},
  {cat:"GACHI", q:"バランスのよい食事を心掛けている", c:["栄養素を管理している", "意識はしている", "気にしない"]},
  {cat:"GACHI", q:"無駄な出費はできる限りしない", c:["1円単位で家計を管理", "貯金はしている", "浪費家だ"]},
  {cat:"GACHI", q:"学生の頃や社会で責任のある役割をした事がある", c:["リーダーや委員長を経験", "補佐などを経験", "ない"]},
  {cat:"GACHI", q:"バイトで無責任な人にイライラする", c:["給料泥棒だと思う", "仕事はしてほしい", "自分は自分と割り切る"]},
  {cat:"GACHI", q:"友達の秘密を言ってしまった事がある", c:["絶対言わない（口が堅い）", "ついうっかりあるかも", "つい話してしまう"]},
  {cat:"GACHI", q:"失敗を繰り返さないように努力する", c:["失敗ノートを作る勢いで徹底", "意識して気をつける", "またやってしまう"]},
  {cat:"GACHI", q:"恋愛では年上が好きだ", c:["落ち着きと教養を求めたい", "どちらかと言えばそう", "年下や同い年がいい"]},
  {cat:"GACHI", q:"電車の遅延などで予定が崩れると一気に疲れる", c:["その日すべてが台無しな気分", "かなりガッカリする", "仕方ないと思う"]},
  {cat:"GACHI", q:"利益が少しずつでもコツコツ積み立てれる", c:["複利の力を信じている", "貯金は得意", "すぐ使ってしまう"]},
  {cat:"GACHI", q:"眠い時は授業中でも友達の車でも寝る", c:["規律を守るため起きていたい", "たまに耐えられない", "すぐ寝る"]},

  // LOVE (61-80)
  {cat:"LOVE", q:"好きな人の誕生日に3万円以上は使いたい", c:["当たり前に使う", "相手が使ってきた金額による", "そんなに使わない"]},
  {cat:"LOVE", q:"恋愛が生活の中心になりやすい", c:["恋人が世界の中心", "仕事と恋愛半々", "趣味や友達が優先"]},
  {cat:"LOVE", q:"相手の言動に一喜一憂しがち", c:["LINE一通で天国と地獄", "少しはテンション上下する", "冷静でいられる"]},
  {cat:"LOVE", q:"返信速度で愛情を測ってしまう", c:["即レス＝愛、遅い＝不安", "少しは気にする", "忙しいだけだと思う"]},
  {cat:"LOVE", q:"曖昧な関係は苦手だ", c:["白黒はっきりさせたい", "少し不安になる", "ゆるい関係もアリ"]},
  {cat:"LOVE", q:"好きな人のわがままなら自分を曲げてでも聞きたい", c:["尽くすのが喜び", "できる範囲で", "嫌なものは断る"]},
  {cat:"LOVE", q:"相手に依存してしまうことがある", c:["24時間一緒にいたい", "たまに寄りかかりすぎる", "自立していたい"]},
  {cat:"LOVE", q:"恋人とはニコイチの存在になりたい", c:["一心同体でありたい", "仲良しでいたい", "別々の人間として過ごしたい"]},
  {cat:"LOVE", q:"失恋した時は予定を潰したことがある", c:["何も手につかなくなる", "1日くらいは休む", "仕事で紛らわす"]},
  {cat:"LOVE", q:"恋人の交友関係にも嫉妬をする", c:["自分以外の異性は全員敵", "少し気になる", "信頼している"]},
  {cat:"LOVE", q:"束縛されると愛されていると感じる", c:["縛られるほど安心する", "多少は嬉しい", "絶対嫌だ"]},
  {cat:"LOVE", q:"恋愛で安心感がないと不安になる", c:["常に愛を確認したい", "たまに不安", "信頼があれば平気"]},
  {cat:"LOVE", q:"曖昧な都合のいい関係は不安になる", c:["耐えられない（病む）", "寂しい時に揺らぐ", "割り切れる"]},
  {cat:"LOVE", q:"1日返信がない時は恋人の予定を知らないと落ち着かない", c:["追いラインする", "気にするが特になにもしない", "全く気にならない"]},
  {cat:"LOVE", q:"相手に依存されたい", c:["必要とされるのが快感", "頼られたい", "自立した人がいい"]},
  {cat:"LOVE", q:"相手の行動を把握していたい", c:["隠し事は許さない", "ある程度は知りたい", "自由にしていい"]},
  {cat:"LOVE", q:"家に帰る時間などの束縛をされたい", c:["門限があるのが愛", "たまになら", "干渉されたくない"]},
  {cat:"LOVE", q:"恋人が最優先になる", c:["友達より恋人との約束", "状況による", "友達や家族も大事"]},
  {cat:"LOVE", q:"好きな人とのメイクや準備に３時間はかかる", c:["３時間", "２時間", "１時間以内"]},
  {cat:"LOVE", q:"恋愛が人生を左右する", c:["恋次第で人生の質が変わる", "他も大切だけど恋愛も大切", "恋愛なんてどうでもいい"]},

  // KAGE (81-99)
  {cat:"KAGE", q:"一人の時間がないとしんどい", c:["絶対に必要", "たまには", "誰かといたい"]},
  {cat:"KAGE", q:"群れるより少人数が楽", c:["2人か3人が限界", "4,5人くらいなら", "大人数が好き"]},
  {cat:"KAGE", q:"学生の頃は群れている人たちは苦手だった", c:["住む世界が違うと思っていた", "少し苦手意識があった", "仲良くしていた"]},
  {cat:"KAGE", q:"周りに合わせすぎるのが苦手", c:["自分を殺したくない", "たまに合わせる", "合わせるのが得意"]},
  {cat:"KAGE", q:"無理にテンションを上げたくない", c:["省エネでいたい", "時と場合による", "常に盛り上がりたい"]},
  {cat:"KAGE", q:"1人カフェなど静かな場所が好き", c:["行く", "あまり行かない", "行ったことがない"]},
  {cat:"KAGE", q:"1日何時間も趣味に時間を使っている", c:["３時間以上", "２時間", "１時間以内"]},
  {cat:"KAGE", q:"人に踏み込まれすぎると疲れる", c:["心の壁がかなり厚い", "少し距離を置く", "歓迎する"]},
  {cat:"KAGE", q:"一人で考える時間が必要", c:["内省こそが生きがい", "たまに必要", "直感で動く"]},
  {cat:"KAGE", q:"自分のペースを乱されたくない", c:["急な誘いは基本NG", "少しイラっとする", "いつでも歓迎"]},
  {cat:"KAGE", q:"遊ぶ時に周りに合わせたファッションをする", c:["浮かないように同化する", "少し意識する", "自分の着たい服を着る"]},
  {cat:"KAGE", q:"空気を読むより距離を取る", c:["面倒な場には最初から行かない", "空気を読んで合わせる", "積極的に関わる"]},
  {cat:"KAGE", q:"無駄な人間関係を減らしたい", c:["連絡先を定期的に整理する", "少しは整理したい", "広い方がいい"]},
  {cat:"KAGE", q:"レジ接客や電話対応が苦手", c:["知らない人と話したくない", "少し緊張する", "平気"]},
  {cat:"KAGE", q:"感情は隠したい/知られたくない", c:["ポーカーフェイスでいたい", "あまり出さない", "顔に出るタイプ"]},
  {cat:"KAGE", q:"深く狭い人間関係が好き", c:["数少ない理解者がいればいい", "どちらかと言えばそう", "浅く広くがいい"]},
  {cat:"KAGE", q:"自分の価値観を曲げたくない", c:["頑固だと言われてもいい", "基本は譲らない", "柔軟に変えられる"]},
  {cat:"KAGE", q:"友達が怒っていたら理不尽なことでも謝る", c:["争うエネルギーが勿体ないので謝る", "納得いかなければ謝らない", "徹底的に話し合う"]},
  {cat:"KAGE", q:"勉強は家でやるよりもカフェや自習室の方が捗る", c:["適度な他人の目がある方がいい", "気分転換になれば", "家が一番いい"]}
];

// 5界隈×3パターンの計15データを追加
const MASTER = {
  SNS: { 
    area: "SNS・自撮り界隈", 
    patterns: [
      {
        min: 35, type: "【デジタル承認モンスター型】",
        thinking: "あなたの脳内は、常に「他者の瞳」という鏡で埋め尽くされています。美味しい食事、美しい景色、日常の些細な出来事さえも、それを体験した瞬間に『これはどう見られるか』『どんな反応が返ってくるか』というメタ視点に変換されてしまいます。情報のキュレーション能力や時代の空気を読む力は圧倒的ですが、その反面、自分の本音と「外向けのキャラ」の境界が曖昧になり、誰にも見られていない自分に価値を感じにくくなっている危険性があります。数字という客観的な指標でしか自分を愛せない、高度に情報化された現代の迷い子といえるでしょう。",
        love: "恋愛においても「見栄え」と「即時性」を無意識に重視します。パートナーが周囲に自慢できる存在であるか、あるいは自分の虚無感を埋めるほどの圧倒的な反応をくれるかが愛のバロメーターです。愛されているという実感よりも、愛されているように周りから見えているか、という社会的証明を優先してしまうため、二人きりの静かな時間よりも、イベントや共有可能な体験に逃げがちです。通知一通で天国から地獄へ落ちるような、非常に不安定な情緒を抱えやすい傾向があります。",
        jobYes: "SNS運用、デジタルマーケティング、トレンドアナリスト、PR・広報、イベントプランナー。",
        jobNo: "長期的な研究職、地味な定型業務、フィードバックが遅い伝統工芸、孤独な守衛。",
        levelup: "1日のうち1時間はスマホを完全に切り、誰にも見せないための「本音日記」を手書きで綴ることで、自分の輪郭を取り戻してください。"
      },
      {
        min: 15, type: "【承認依存・迷走型】",
        thinking: "あなたはSNSを使いこなしながらも、常に「正解の投稿」を探して疲弊しています。自分を良く見せたいという欲求はあるものの、突き抜けるほどの自信はなく、他人の反応に一喜一憂する日々を送っています。オリジナリティよりも「外さないこと」を優先し、バズっているものに自分を寄せていく器用さがありますが、その分、自分の本当の感性が死に体になっています。ネットの熱狂と現実の空虚さのギャップに、人知れず虚しさを感じているタイプです。",
        love: "恋人に対しても「SNSに出せるか」を無意識に判定材料にしています。しかし、深い部分での繋がりよりも表面的な盛り上がりを求めてしまい、関係がマンネリ化するとすぐに新しい刺激を求めて画面の中へ逃避します。自分の機嫌を自分で取ることが苦手なため、相手のレスポンスの早さに依存しやすく、少しの既読スルーで世界が終わったかのような絶望感を味わいます。",
        jobYes: "WEBライター、メディア運営、アパレル販売、インフルエンサーマネージャー。",
        jobNo: "緻密な計算を要する専門職、電話対応のみの事務、変化のない単純作業。",
        levelup: "「いいね」がつかない趣味をあえて一つ作ってください。誰にも評価されない喜びを知ることが、あなたの心を救います。"
      },
      {
        min: -99, type: "【冷笑系・嫉妬予備軍型】",
        thinking: "SNSを批判的に見つつも、その実、誰よりも「数字」を意識しています。バズっている人を「浅い」と切り捨てながら、心の中ではその影響力を激しく羨んでいる複雑な精神構造です。自分を表現したい欲求は人一倍強いのですが、叩かれることや反応がないことを恐れて、あえて「興味がないフリ」を装っています。匿名掲示板や裏垢で毒を吐くことでバランスを取っていますが、その毒は巡り巡ってあなた自身の自己肯定感を削り続けています。",
        love: "素直になれない恋愛をしがちです。相手の好意を素直に受け取れず、つい皮肉を言ったり試すような態度を取ってしまいます。ロマンチックな演出を「寒い」と笑いながら、内心では誰よりも強い愛情を渇望しています。自分が傷つかないことを最優先にするあまり、大切なチャンスを自ら潰してしまう自虐的な側面があります。",
        jobYes: "デバッグ作業員、データ収集、匿名ライター、分析業務。",
        jobNo: "顔出しが必須の営業、明るさが売りの接客、チームビルディングが中心の職場。",
        levelup: "「ダサい自分」を一度認めてみてください。プライドを捨てて何かに熱中する姿は、あなたが思うほど惨めではありません。"
      }
    ]
  },
  GLAM: { 
    area: "夜職界隈", 
    patterns: [
      {
        min: 35, type: "【自己武装ハイグレード型】",
        thinking: "「自分という存在は、磨き上げ、演出し、高く売るべき商品である」という冷徹なまでのプロ意識があなたの思考の核です。容姿や持ち物、振る舞いのすべては、社会という戦場で優位に立つための『武装』。現状に満足することを自分に許さず、常にアップデートし続けようとするバイタリティは強烈ですが、その根底には『素の自分には一文の価値もない』という深い絶望と恐怖が横たわっています。他人を「自分より上か下か」で測る癖があり、常に競争の中に身を置くため、心が休まる暇がありません。",
        love: "恋愛は、ある種の「価値交換」の側面が強くなります。自分と同等か、それ以上のスペック（経済力、美貌、権力）を持つ相手をトロフィーとして求め、ナメられないための武装を恋人の前でも解くことができません。奢られることや高価なギフトを、愛情ではなく『自分の市場価値への対価』として受け取るため、無償の愛や精神的な弱さの露呈を極端に恐れます。本音で甘えることが「負け」だと思ってしまう、プライドに縛られた寂しがり屋です。",
        jobYes: "不動産・外車営業、美容外科コンサル、芸能、ハイエンドな接客業、起業家。",
        jobNo: "ボランティア活動、個性を抑える公務員、地味な事務作業、福祉・介護の現場。",
        levelup: "「何の役にも立たない、何の武器も持っていない自分」を面白がってくれる友人と、泥臭く笑い合える時間を持ってください。"
      },
      {
        min: 15, type: "【背伸び・マウント型】",
        thinking: "あなたは今の生活水準や容姿に100%満足しておらず、常に「もっと上があるはずだ」という渇望感に支配されています。ブランド品や美容への投資は、自信をつけるためというより、周囲に対する防衛反応に近いものです。自分より恵まれている人間を見つけると激しく落ち込み、逆に自分より下だと判断した人間に対しては露骨に優越感を感じることで、心の平穏を保っています。常に誰かと比較し続ける「終わりのないレース」に参加している状態です。",
        love: "相手のステータスに敏感です。連れて歩いて恥ずかしくないか、自分の生活を豊かにしてくれるかをシビアに計算します。一方で、自分の弱みを見せるのが苦手なため、常に「完璧な自分」を演じ続けてしまい、深い信頼関係を築く前に疲弊して別れを選ぶことが多いです。愛情表現を物質的な豊かさと直結させて考える癖があります。",
        jobYes: "カウンターセールス、高級アパレル、モデル、美容部員。",
        jobNo: "泥臭い作業、地味な裏方、薄給のやりがい搾取、年功序列の古い企業。",
        levelup: "1円もお金をかけない「自然の中での休日」を過ごしてみてください。消費しない自分にも価値があると気づくことが大切です。"
      },
      {
        min: -99, type: "【素材依存・コンプレックス型】",
        thinking: "自分はもっと美しく、価値ある存在になれるはずだと信じながら、現実とのギャップに苦しんでいます。自己投資への憧れは強いものの、行動が伴わなかったり、中途半端な結果に終わることが多く、それがさらなるコンプレックスを生んでいます。自分を磨くことよりも、他人を羨むことにエネルギーを割いてしまいがちです。「いつか自分も」という希望だけで、現在の自分を疎かにしている、ある種の現実逃避状態にあります。",
        love: "「自分のような人間が愛されるはずがない」という卑屈さと、「もっと素敵な人が現れるはずだ」という理想が同居しています。そのため、自分を大切にしてくれる人を蔑ろにし、逆に自分を雑に扱う高嶺の花に執着する傾向があります。愛されることへの恐怖心が強く、幸せになりそうになると自らぶち壊すような行動を取ることがあります。",
        jobYes: "一般事務、軽作業、電話オペレーター、ルーチンワーク。",
        jobNo: "競争の激しい完全歩合制、美意識を問われる現場、リーダーシップが必要な役職。",
        levelup: "今の自分のままでもできる「小さな成功体験」を積み上げてください。大きな整形や買い物よりも、日々の筋トレや貯金が自信になります。"
      }
    ]
  },
  GACHI: { 
    area: "メガネ真面目くん界隈", 
    patterns: [
      {
        min: 35, type: "【規律の守護者・ジャッジ型】",
        thinking: "あなたの思考は、論理、規律、そして「正しさ」という堅牢な城壁で守られています。世界は予測可能であるべきで、ルールやマナーは社会を円滑に回すための絶対的な法だと信じています。責任感が強く、あなたの管理下にあるものは完璧に整理されますが、同時に「正論という名の凶器」で他者を無自覚に追い詰める冷酷さも持ち合わせています。非効率なことや、感情論で動く人間を心底軽蔑しており、予定が狂うことへの耐性が極端に低い、完璧主義的な観測者です。",
        love: "恋愛に対しては非常に誠実で計画的ですが、同時に「採点」を行う傾向があります。デートの段取りや将来設計は完璧ですが、相手に対しても同じレベルのマナーや常識を厳格に要求します。愛を言葉や情緒ではなく、行動の積み重ねやルールの遵守で測るため、相手が求めている『ただ寄り添ってほしい』という曖昧なニーズを「非論理的だ」と切り捨ててしまうことがあります。安定は提供しますが、相手に息苦しさを感じさせやすいタイプです。",
        jobYes: "エンジニア、会計士、法務、品質管理、公務員、データサイエンティスト。",
        jobNo: "即興性が命のお笑い芸人、混沌としたベンチャー営業、芸術家、ルールなき自由業。",
        levelup: "「無駄の中にこそ人生の豊かさがある」と自分に言い聞かせ、あえて計画を立てない放浪の旅に出ることで許容範囲を広げてください。"
      },
      {
        min: 15, type: "【常識遵守・苦労人型】",
        thinking: "真面目であること、ちゃんとしていることが「正解」だと信じて疑わず、社会のレールから外れないように必死に生きている努力家です。しかし、その根底にあるのは信念ではなく「周囲から浮くことへの恐怖」です。自分の意見よりも世間の常識を優先しすぎるため、ストレスが溜まりやすく、不真面目に楽しそうに生きている人間に対して密かな殺意に近い不快感を覚えています。自分を律することで得られる安心感よりも、抑圧による疲労が勝っている状態です。",
        love: "石橋を叩きすぎて壊すタイプです。慎重になりすぎてアプローチの機会を逃したり、相手の欠点を「常識がない」と即座に切り捨ててしまったりします。波風の立たない平穏な関係を望みますが、刺激を求めるパートナーからは「つまらない人」というレッテルを貼られやすいです。結婚相手としては最高ですが、恋人としては遊び心が不足しがちです。",
        jobYes: "銀行員、一般事務、教職員、図書館司書、薬剤師。",
        jobNo: "ノルマが激しい営業、夜型の仕事、不規則なクリエイティブ職、スタートアップ。",
        levelup: "たまには「ズル」をしたり、意図的にサボったりしてみてください。世界が崩壊しないことを知れば、もっと楽に生きられます。"
      },
      {
        min: -99, type: "【形骸化・指示待ち型】",
        thinking: "真面目だと思われたい、というポーズだけが先行し、中身が伴っていないタイプです。言われたことは守りますが、それ以上の工夫や自発的な行動は苦手です。「ちゃんとしなきゃ」という言葉が口癖ですが、実際には締切をギリギリまで引き伸ばしたり、小さな嘘で取り繕ったりする矛盾を抱えています。責任を負うことを極端に避け、常に逃げ道を確保しながら「自分は頑張っている」と自分に言い聞かせている、精神的な甘えがあります。",
        love: "相手にリードされることを望みますが、相手がミスをすると「普通はこうするでしょ」と真面目ぶって批判します。自分を棚に上げて、理想のパートナー像を押し付ける傾向があります。責任感が欠如しているため、困難に直面すると話し合いを避けて音信不通になったり、逃げ出したりする臆病な側面を持っています。",
        jobYes: "マニュアル完備の作業、公的な窓口業務、校正、清掃員。",
        jobNo: "裁量の大きい経営職、アドリブが求められる司会業、リーダーシップが必要な現場。",
        levelup: "「自分の言葉に責任を持つ」ことから始めてください。嘘をやめ、小さな約束を確実に守ることが、あなたの信頼を再構築します。"
      }
    ]
  },
  LOVE: { 
    area: "恋愛至上主義界隈", 
    patterns: [
      {
        min: 35, type: "【共依存・愛の重力型】",
        thinking: "あなたの人生のコンパスは、常に「自分以外の誰か」を指しています。自分の幸福、価値、存在意義さえも、隣にいる誰かの機嫌や言葉によって決定されてしまう、極めて献身的ながらも依存的な思考の持ち主です。感受性が非常に豊かで、相手の微細な表情の変化から感情を読み取る力に長けていますが、その分、一人の時間を「自分という器に何もない空虚な時間」と感じ、耐えることができません。愛することこそが生きる目的であり、それ以外はすべて背景に過ぎないと考えています。",
        love: "愛することとは、相手と「同化」することだと思い込んでいます。境界線を越えて相手のすべてを知り、共有し、支配し合いたいという欲求が強く、束縛を愛の証明として熱烈に歓迎します。24時間繋がっていることに安心感を覚え、少しでも連絡が途絶えると自分の存在が消えてしまうようなパニックに陥ります。その重すぎる愛の重力は、最初は相手を心地よく包みますが、次第に相手の酸素を奪い、結果的に関係を破綻させてしまう悲劇性を秘めています。",
        jobYes: "カウンセラー、看護師、ブライダル業界、ベビーシッター、ファンコミュニティ運営。",
        jobNo: "冷徹な判断を下す経営者、孤高の研究職、数字だけを追うトレーダー、警備員。",
        levelup: "「一人の時間を自分自身を愛するためのデート」と考え、自分一人の機嫌を自分で取るスキル（セルフケア）を徹底的に磨いてください。"
      },
      {
        min: 15, type: "【献身・お世話し型】",
        thinking: "自分を犠牲にしてでも他人に尽くすことで、自分の存在価値を確認しようとするタイプです。困っている人を放っておけず、つい世話を焼いてしまいますが、その動機は純粋な善意ではなく「必要とされないことへの恐怖」です。自分がいないと相手がダメになる、という状況に快感を覚えるため、あえて不健康な相手や問題のある相手を選んでしまう「ダメ男・ダメ女メーカー」の素質があります。自分の幸せが二の次になっていることに気づかない、自己犠牲の殉教者です。",
        love: "尽くしすぎて、結果的に相手を甘やかしてダメにします。相手のわがままを全て受け入れることが愛だと思っていますが、それは対等な関係を放棄しているのと同じです。感謝の言葉がないと急激に病み始め、「こんなにやってあげているのに」という恨み節を溜め込む傾向があります。愛されることよりも、必要とされることに執着しているため、不健全な関係から抜け出せません。",
        jobYes: "介護職、保育士、秘書、動物保護活動、サービス業全般。",
        jobNo: "感情を挟まない法的業務、孤高の専門職、結果がすべての冷酷な営業。",
        levelup: "「何もしないあなた」を好きだと言ってくれる人の言葉を信じてください。誰かを救わなくても、あなたは価値があります。"
      },
      {
        min: -99, type: "【愛への不信・受動型】",
        thinking: "愛に憧れながらも、心のどこかで「愛なんて長続きしない」「自分は本気で愛されるはずがない」と冷笑しています。傷つくのを恐れて、自分から深く踏み込むことはせず、常に相手からのアプローチを待つだけの受動的な姿勢を貫いています。しかし、一度扉を開かれると極端な依存を見せるというギャップがあり、その不安定さが周囲を振り回します。自分に自信がないため、相手の些細な行動を「嫌われたサイン」として過剰に解釈する、疑心暗鬼な観測者です。",
        love: "試し行為の常習犯です。わざとそっけない態度を取って相手の反応を見たり、無理難題を言って愛情を確かめようとします。その実、自分は何も提供せず、相手に100%の安心を要求します。愛に飢えているのに愛を拒絶するという矛盾した行動により、自ら幸せを遠ざけています。一人でいる寂しさよりも、誰かといて感じる不安の方が強いタイプです。",
        jobYes: "倉庫作業、清掃、工場のライン、データ入力。",
        jobNo: "チームワークが必須の現場、対人交渉が中心の仕事、常に明るさが求められる場。",
        levelup: "まずは自分自身を信頼することから始めてください。あなたがあなたを嫌いなままでは、誰の愛もザルで水を掬うように消えてしまいます。"
      }
    ]
  },
  KAGE: { 
    area: "自分を持ってるインキャラ界隈", 
    patterns: [
      {
        min: 35, type: "【孤高の観測者・バリア型】",
        thinking: "あなたの内側には、誰にも侵入を許さない広大で静謐な「自分だけの王国」が存在します。社会生活は、その王国を維持するための外貨稼ぎに過ぎず、群れることや同調することに本質的な意味を見出せません。物事を斜めから、あるいは極めて深く洞察する力を持っており、表面的な会話を「ノイズ」として嫌悪します。否定されることを極端に恐れるため、自分の本質を厚いバリアで隠しており、他人に期待しないことを処世術として身につけている、賢明で孤独な魂です。",
        love: "精神的な深いつながりを何よりも切望しながら、物理力・心理的なパーソナルスペースを侵されることを激しく拒絶するという矛盾を抱えています。恋人であっても、自分の思考の海をかき乱す存在だと判断した瞬間に、心を閉ざしてシャッターを下ろしてしまいます。言葉を尽くして伝えることを「野暮」だと感じ、説明不足からくるすれ違いを『どうせ理解されない』と諦めて放置する傾向があります。理解者は極めて少数でいいと割り切っている、孤高のロマンチストです。",
        jobYes: "作家、プログラマー、研究者、司書、イラストレーター、校正者。",
        jobNo: "イベントMC、飛び込み営業、コールセンター、体育会系のチームプロジェクト。",
        levelup: "自分の考えていることを、あえて「1.5倍」の熱量で言葉にしてみてください。あなたが思う以上に、世界はあなたの声を待っています。"
      },
      {
        min: 15, type: "【隠れ・こだわり型】",
        thinking: "一見すると大人しく従順に見えますが、その実、非常に強固なこだわりと美学を持っている「羊の皮を被った狼」的なタイプです。興味のないことには一切指一本動かしませんが、好きなことには寝食を忘れて没頭するオタク的な集中力を秘めています。社会的なコミュニケーションは「コスプレ」のように演じている感覚があり、自宅の玄関を閉めた瞬間に本当の自分が始まると感じています。自分の好みを理解されないことに慣れすぎており、最初から対話を諦めている節があります。",
        love: "「同じ温度で沈黙を楽しめるか」が最重要です。派手なデートよりも、家で別々のことをしながら同じ空間にいるような関係を好みます。しかし、自分のルールを相手に強要したり、自分の世界に没入しすぎてパートナーを空気のように扱ってしまう無神経さがあります。愛していないわけではないのですが、優先順位のトップが常に「自分の世界」にあるため、寂しい思いをさせがちです。",
        jobYes: "専門職の裏方、WEBデザイン、翻訳、職人仕事、システム保守。",
        jobNo: "大人数の飲み会が必須の職場、チームプレーを強要する会社、常に連絡を求められる仕事。",
        levelup: "あなたの「好き」を、同じ熱量を持つ人にだけは開示してみてください。共鳴する喜びが、あなたのバリアを少しだけ溶かしてくれます。"
      },
      {
        min: -99, type: "【同調・消極型】",
        thinking: "自分というものが希薄で、周囲の環境や人間関係に流されるまま生きているタイプです。一人の時間が好きだと言いつつ、実際には何をしていいか分からずスマホを眺めて時間が過ぎることに焦燥感を感じています。個性的でありたいという願望はありますが、具体的な「核」がないため、結局は無難な選択を繰り返しています。自分の意見を言うのが苦手で、空気を読んで周囲に合わせますが、その分内側にはドロドロとした不満を溜め込んでいる、内弁慶な側面があります。",
        love: "押しに弱く、好きでもない相手と付き合ってしまうことがあります。付き合ってからも不満を言えず、相手に従い続けますが、ある日突然キャパオーバーになって爆発するか、何も言わずに消えるような極端な行動を取りがちです。対等な関係を築くための「話し合い」というプロセスを最も苦手としており、常に誰かの影に隠れていたいという依存心があります。",
        jobYes: "軽作業、配送業務、公的なルーチンワーク、農作業。",
        jobNo: "企画立案が求められる仕事、タフな交渉が必要な現場、主体性が売りのベンチャー。",
        levelup: "「嫌なことは嫌だ」と、まずは小さなことから声に出す練習をしてください。あなたの輪郭を作るのは、あなた自身の拒絶と選択です。"
      }
    ]
  }
};

let state = { 
  idx: 0, 
  scores: {SNS:0, GLAM:0, GACHI:0, LOVE:0, KAGE:0}, 
  history: [], 
  ans: null, 
  timerVal: 45, 
  timer: null,
  qList: []
};

window.onload = () => {
  if (localStorage.getItem('mbti_plus_vfinal')) document.getElementById('resume-btn').classList.remove('hide');
};

function shuffle(array) {
  for (let i = array.length - 1; i > 0; i--) {
    const j = Math.floor(Math.random() * (i + 1));
    [array[i], array[j]] = [array[j], array[i]];
  }
  return array;
}

function start(resume) {
  if(resume) {
    state = JSON.parse(localStorage.getItem('mbti_plus_vfinal'));
  } else {
    state.qList = shuffle([...DB]);
    state.idx = 0;
    state.scores = {SNS:0, GLAM:0, GACHI:0, LOVE:0, KAGE:0};
    state.history = [];
  }
  document.getElementById('screen-intro').classList.add('hide');
  document.getElementById('screen-quiz').classList.remove('hide');
  render();
}

function render() {
  const qText = document.getElementById('question-text');
  const choices = document.getElementById('choices');
  const fill = document.getElementById('progress-fill');
  localStorage.setItem('mbti_plus_vfinal', JSON.stringify(state));
  
  choices.innerHTML = "";
  if (state.idx < 99) {
    const q = state.qList[state.idx];
    qText.textContent = q.q;
    document.getElementById('q-num').textContent = state.idx + 1;
    fill.style.width = `${state.idx + 1}%`;
    q.c.forEach((txt, i) => {
      const btn = document.createElement('button');
      btn.textContent = txt;
      btn.onclick = () => {
        state.history.push({scores:{...state.scores}});
        state.scores[q.cat] += (i===0?2 : (i===1?0 : -1));
        state.idx++; render();
      };
      choices.appendChild(btn);
    });
  } else { renderFinal(); }
}

function renderFinal() {
  document.getElementById('screen-quiz').classList.add('extreme-mode');
  document.getElementById('timer-ui').classList.remove('hide');
  document.getElementById('force-finish-btn').classList.add('hide');
  document.getElementById('q-num').textContent = "100";
  document.getElementById('progress-fill').style.width = "100%";
  
  const qText = document.getElementById('question-text');
  qText.style.textAlign = "left";
  qText.innerHTML = `<span style="color:#ff4477; font-size:1.2rem; font-weight:900;">【運命のボタン】</span><br><br>
    想像してください。ここに、押すと1億円が手に入るボタンがあります。<br>
    ルールはたった二つ。<br>
    1. あなた自身はこのボタンを押すことができない。<br>
    2. 友人がこのボタンを押せば、友人は1億円を得るが、代わりにあなたは消滅する。<br><br>
    ここで問いましょう。<br>
    <strong>「あなたはこのボタンを、友人に預けれますか？」</strong><br><br>
    これは、命と金のどちらが大事かを天秤にかける問題ではありません。あなたの<strong>「傲慢さ」</strong>をはかる問題です。
    友人を「金のために自分を殺す男だ」として預けないのか。
    それとも、踏み絵のように友人に「信じてるぞ、絶対にあいつなら押さない」と預けるのか。<br><br>
    さあ、あなたの傲慢な回答を聞かせてください。`;
  
  const choices = document.getElementById('choices');
  choices.innerHTML = "";
  ["預ける", "預けない"].forEach((txt, i) => {
    const btn = document.createElement('button');
    btn.textContent = txt;
    btn.style.textAlign = "center";
    btn.onclick = () => { clearInterval(state.timer); state.ans = (i===0?'yes':'no'); showResult(); };
    choices.appendChild(btn);
  });

  state.timer = setInterval(() => {
    state.timerVal--;
    document.getElementById('timer-display').textContent = state.timerVal;
    if(state.timerVal <= 0) { clearInterval(state.timer); state.ans = 'silence'; showResult(); }
  }, 1000);
}

function forceFinish() {
  if(confirm("【警告】\nまだ全ての質問に回答していません。正確性が落ちますが、よろしいですか？")) {
    state.ans = 'interrupted';
    showResult();
  }
}

// 判定ロジックを「点数に応じた3パターン」に対応
function showResult() {
  document.getElementById('screen-quiz').classList.add('hide');
  document.getElementById('screen-result').classList.remove('hide');
  
  const top = Object.keys(state.scores).reduce((a,b)=> state.scores[a] > state.scores[b]? a : b);
  const topScore = state.scores[top];
  const catData = MASTER[top];

  // スコアによって3パターンのうちどれかを選ぶ
  const pattern = catData.patterns.find(p => topScore >= p.min);

  document.getElementById('res-area').textContent = catData.area;
  document.getElementById('res-type').textContent = pattern.type;
  document.getElementById('res-thinking').textContent = pattern.thinking;
  document.getElementById('res-love').textContent = pattern.love;
  document.getElementById('res-job-yes').textContent = pattern.jobYes;
  document.getElementById('res-job-no').textContent = pattern.jobNo;
  document.getElementById('res-levelup').textContent = pattern.levelup;

  let finalMsg = "";
  if(state.ans === 'yes') {
    finalMsg = `<span style="color:#ff4477; font-weight:900;">【運命のボタン：預けると答えたあなた】</span><br><br>
    その「信用」は、ただの押し付けなのではないでしょうか。<br>
    あなたは「あの人なら、絶対にボタンを押さない」と信じて、ボタンを渡したのかもしれません。でも、それは本当の信頼ですか？<br>
    想像してください。渡された側の友達は、一生そのボタンを見るたびに「これを押せば1億円が手に入る」という誘惑と戦い続けることになります。<br>
    あなたは「信用している」という綺麗な言葉を盾にして、一番大切な人に「一生続く拷慢」をプレゼントしただけではないですか？<br>
    「信じているから渡す」という行為。それは裏を返せば、「もし押したら、お前が悪い」という呪いをかけているのと同じです。相手を試さずにはいられない。その傲慢な確認作業を、あなたは「友情」と呼んでいるのです。<br><br>
    <strong>【結論：この問いの正体】</strong><br>
    この質問は、友情の深さなんて聞いていません。暴かれているのは、あなたの<strong>「傲慢さ」</strong>です。<br>
    ・渡せば、相手に「踏み絵」を迫る、傲慢な試練。<br>
    ・渡さなければ、相手の理性を疑う、冷ややかな侮蔑。<br>
    どちらを選んでも、あなたは「1億円」という紙切れ一枚で、あの人との絆を汚してしまった。`;
  } else if(state.ans === 'no') {
    finalMsg = `<span style="color:#ff4477; font-weight:900;">【運命のボタン：預けないと答えたあなた】</span><br><br>
    あなたは、あの人を「見くびって」いるのではありませんか？<br>
    あなたは「預けない」を選びました。「あの人を人殺しにしたくない」「迷わせたくない」と、自分を納得させているかもしれません。でも、本当の理由は違いますよね。<br>
    あなたは、あの人が「1億円」という金額に負けて、あなたを殺してしまうことを確信している。<br>
    「どうせ渡せば、あいつは迷うだろう。もしかしたら、押してしまうかもしれない」<br>
    あなたは、一番大切なはずの友達関係を、たった1億円程度の価値の関係だと見積もっているのです。<br><br>
    <strong>【結論：この問いの正体】</strong><br>
    この質問は、友情の深さなんて聞いていません。暴かれているのは、あなたの<strong>「傲慢さ」</strong>です。<br>
    ・渡せば、相手に「踏み絵」を迫る、傲慢な試練。<br>
    ・渡さなければ、相手の理性を疑う、冷ややかな侮蔑。<br>
    どちらを選んでも、あなたは「1億円」という紙切れ一枚で、友人との絆を汚してしまったのです。`;
  } else if(state.ans === 'silence') {
    finalMsg = `<span style="color:#ff4477; font-weight:900;">【沈黙したあなた】</span><br><br>
    あなたは、どちらのボタンも選べなかった。あるいは、選ばないことを選んだ。それは「迷い」ではありません。<br>
    <strong>「あの人と1億円を、同じ天秤に載せること自体を拒否した」</strong>という、唯一の誠実な回答です。<br><br>
    「渡す」を選れば相手を試し、「渡さない」を選べば相手を疑うことになる。その汚い二択を突きつけられたとき、あなたはただ静かに、時間が過ぎるのを待った。それは、1億円という数字が、あなたとあの人の間に入り込む余地を一切与えなかったということです。<br><br>
    <strong>【この問いの正体】</strong><br>
    この質問において、用意された二つのボタンは「罠」でした。<br>
    ・「渡す」は、信頼を盾にした傲慢。<br>
    ・「渡さない」は、不信を隠した諦め。<br>
    そして、あなたの「沈黙」だけが、唯一の「誠実」です。<br><br>
    <strong>【最後に】</strong><br>
    答えは、用意された選択肢の中にはありません。ですが、世の中は、いつだってあなたに「二択」を迫ります。しかし、本当に大切なものほど、天秤には載りません。あなたが選んだ<strong>「沈黙」</strong>という回答は、その汚い天秤を根底から否定するものでした。<br><br>
    世の中はアルファベットや点数であなたを分類、区別ジャンル分けしようとしてきます。皮肉なことに、この診断もあなたの性格を「タイプ」という枠に閉じ込めるために作られました。でもこの問題では、あなたは誰にも分類できない「あなた自身」だったのです。<br><br>
    人生は、二択のようで、二択ではない問題が存在し、ヒトはあなたを分類しようとしてきます。ですがヒトはもっと繊細で不明瞭なのではないでしょうか。<br><br>
    その不器用で、優しくて、曖昧で不明瞭な感性を、どうか一生大切にしていてください。`;
  } else {
    finalMsg = "【中断された結果】<br>全質問に回答していないため、深層分析はロックされています。";
  }
  document.getElementById('final-box').innerHTML = finalMsg;
}

function goBack() { 
  if(state.idx > 0) { 
    state.idx--; 
    state.scores = state.history.pop().scores; 
    render(); 
  } 
}
function resetAll() { localStorage.clear(); location.reload(); }
</script>
</body>
</html>
