<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>えむびーてぃーあいPlus</title>
  <style>
    :root {
      --bg: #0b1020;
      --card: rgba(255, 255, 255, .08);
      --accent: #bda6ff;
      --accent2: #6ef2ff;
      --accent3: #ff7ca7;
      --text: rgba(255, 255, 255, .95);
      --muted: rgba(255, 255, 255, .6);
    }
    * { box-sizing: border-box; }
    body {
      margin: 0; min-height: 100vh;
      font-family: "Helvetica Neue", Arial, "Hiragino Kaku Gothic ProN", "Hiragino Sans", sans-serif;
      color: var(--text);
      background: radial-gradient(circle at top right, #1a1a3a, #0b1020);
      display: flex; justify-content: center; align-items: center;
      padding: 15px;
    }
    .container { max-width: 650px; width: 100%; }
    .card {
      background: var(--card); border: 1px solid rgba(255,255,255,.15);
      border-radius: 28px; padding: 40px; box-shadow: 0 30px 60px rgba(0,0,0,0.6);
      backdrop-filter: blur(12px); transition: all 0.5s ease;
    }
    /* 100問目特別モード */
    .special-mode { background: #000 !important; border-color: #333 !important; }

    .hide { display: none !important; }
    h1 { font-size: 28px; margin: 0 0 10px; font-weight: 900; background: linear-gradient(90deg, var(--accent3), var(--accent)); -webkit-background-clip: text; color: transparent; }
    
    .progress-wrap { display: flex; align-items: center; gap: 10px; margin-bottom: 30px; }
    .progress-bar { flex-grow: 1; height: 6px; background: rgba(255,255,255,.1); border-radius: 3px; overflow: hidden; }
    .progress-fill { height: 100%; background: linear-gradient(90deg, var(--accent), var(--accent2)); width: 0%; transition: 0.4s cubic-bezier(0.1, 0.7, 1.0, 0.1); }
    
    .question-text { font-size: 20px; font-weight: bold; line-height: 1.6; min-height: 100px; margin-bottom: 30px; letter-spacing: 0.02em; }
    .choices { display: grid; gap: 15px; }
    
    button {
      padding: 18px; border-radius: 16px; border: 1px solid rgba(255,255,255,.12);
      background: rgba(255,255,255,.07); color: white; cursor: pointer; font-size: 16px; font-weight: bold; transition: 0.3s;
    }
    button:hover { background: rgba(255,255,255,.18); transform: translateY(-2px); border-color: var(--accent); }
    
    .timer-circle {
      width: 80px; height: 80px; border-radius: 50%; border: 4px solid var(--accent3);
      display: flex; justify-content: center; align-items: center;
      margin: 0 auto 20px; font-size: 30px; font-weight: 900;
      animation: pulse 1s infinite;
    }
    @keyframes pulse { 0% { transform: scale(1); opacity: 1; } 50% { transform: scale(1.05); opacity: 0.7; } 100% { transform: scale(1); opacity: 1; } }

    .result-content { line-height: 2; white-space: pre-wrap; font-size: 16px; text-align: justify; }
    .type-title { font-size: 24px; font-weight: 900; color: var(--accent2); margin-bottom: 10px; }
  </style>
</head>
<body>

<div class="container">
  <div id="screen-intro" class="card">
    <h1>えむびーてぃーあいPlus</h1>
    <p style="color:var(--muted); line-height:1.7;">100問のシチュエーションから、あなたの深層心理を暴き出す詳細診断。最後に待ち受けるのは、あなたの「信頼」を問う究極の質問。</p>
    <button style="width:100%; margin-top:30px; background:white; color:black;" onclick="startQuiz()">診断を開始する</button>
  </div>

  <div id="screen-quiz" class="card hide">
    <div id="timer-ui" class="hide">
      <div id="timer-display" class="timer-circle">35</div>
    </div>
    <div class="progress-wrap">
      <div id="step-count" style="font-size:14px; color:var(--muted); font-weight:bold; width:80px;">Q.001</div>
      <div class="progress-bar"><div id="progress-fill" class="progress-fill"></div></div>
    </div>
    <div id="question-text" class="question-text"></div>
    <div id="choices" class="choices"></div>
  </div>

  <div id="screen-result" class="card hide">
    <div id="result-badge" style="color:var(--accent3); font-weight:bold; margin-bottom:5px; font-size:14px;">ANALYSIS RESULT</div>
    <div id="result-title" class="type-title"></div>
    <div id="result-text" class="result-content"></div>
    <button style="width:100%; margin-top:40px;" onclick="location.reload()">もう一度診断する</button>
  </div>
</div>

<script>
/* 100問のデータ */
const RAW_QUESTIONS = [
  /* SNS */
  {cat:"SNS", q:"バズっている投稿を見ると、いいね数やコメント数を必ず確認する", a:"見ない", b:"たまに", c:"必ず"},
  {cat:"SNS", q:"自分の投稿の反応が少ないと少し落ち込む", a:"全く", b:"少し", c:"かなり"},
  {cat:"SNS", q:"ストーリーを上げた後、誰が見たか頻繁に確認する", a:"しない", b:"たまに", c:"必ず"},
  {cat:"SNS", q:"友達の投稿が伸びていると、その理由を分析してしまう", a:"しない", b:"少し", c:"する"},
  {cat:"SNS", q:"SNSでの自分のキャラや立ち位置を意識している", a:"意識しない", b:"たまに", c:"常に"},
  {cat:"SNS", q:"炎上している話題はつい最後まで追ってしまう", a:"追わない", b:"たまに", c:"最後まで"},
  {cat:"SNS", q:"フォロワー数でその人の影響力を判断することがある", a:"しない", b:"少し", c:"ある"},
  {cat:"SNS", q:"投稿する時間帯や内容の『映え』を気にする", a:"気にしない", b:"少し", c:"かなり"},
  {cat:"SNS", q:"SNSで誰にも反応されないと孤独を感じる", a:"感じない", b:"少し", c:"かなり"},
  {cat:"SNS", q:"他人のキラキラした投稿に嫉妬することがある", a:"ない", b:"たまに", c:"よくある"},
  {cat:"SNS", q:"SNSの通知が来るとすぐに確認したくなる", a:"ならない", b:"たまに", c:"すぐ"},
  {cat:"SNS", q:"バズるための法則やノウハウに興味がある", a:"ない", b:"少し", c:"かなり"},
  {cat:"SNS", q:"SNSの数字は自分の市場価値だと思える", a:"思わない", b:"少し", c:"思う"},
  {cat:"SNS", q:"匿名掲示板や裏垢で本音を吐き出す場所がある", a:"ない", b:"たまに", c:"ある"},
  {cat:"SNS", q:"流行りの言葉やハッシュタグを積極的に使う", a:"使わない", b:"たまに", c:"よく使う"},
  {cat:"SNS", q:"自分の投稿がどう思われるか何度も書き直す", a:"直さない", b:"1回", c:"何度も"},
  {cat:"SNS", q:"いいねが少ないと、その投稿を消したくなる", a:"ない", b:"少し", c:"ある"},
  {cat:"SNS", q:"SNSがない世界は考えられない", a:"考えられる", b:"少し困る", c:"無理"},
  {cat:"SNS", q:"オンライン上の繋がりもリアルと同等に大事だ", a:"違う", b:"少し", c:"同等"},
  {cat:"SNS", q:"エゴサーチをよくする方だ", a:"しない", b:"たまに", c:"頻繁に"},

  /* GLAM */
  {cat:"GLAM", q:"見た目は一番の武器だと思う", a:"思わない", b:"半分", c:"強く思う"},
  {cat:"GLAM", q:"ナメられたくないという気持ちが人一倍強い", a:"弱い", b:"普通", c:"強い"},
  {cat:"GLAM", q:"高級なものやブランドを身につけると自信が出る", a:"出ない", b:"少し", c:"出る"},
  {cat:"GLAM", q:"自分より目立っている人を見るとライバル心が湧く", a:"湧かない", b:"少し", c:"湧く"},
  {cat:"GLAM", q:"整形や美意識への投資は当然の努力だ", a:"違う", b:"まあ", c:"当然"},
  {cat:"GLAM", q:"プライドが高く、負けを認めるのが苦手だ", a:"認める", b:"普通", c:"苦手"},
  {cat:"GLAM", q:"お金を稼ぐことは何よりも優先されるべきだ", a:"違う", b:"少し", c:"優先"},
  {cat:"GLAM", q:"自分のステータスを上げるための努力は惜しまない", a:"惜しむ", b:"普通", c:"惜しまない"},
  {cat:"GLAM", q:"成功者との繋がりを重視する", a:"しない", b:"少し", c:"かなり"},
  {cat:"GLAM", q:"弱みを見せることは恥ずかしいと思う", a:"思わない", b:"少し", c:"思う"},
  {cat:"GLAM", q:"カリスマ性のある人間に憧れる", a:"ない", b:"少し", c:"かなり"},
  {cat:"GLAM", q:"世の中、結局は『顔』と『金』だと思う", a:"違う", b:"半分", c:"思う"},
  {cat:"GLAM", q:"自分を大きく見せるための嘘を吐くことがある", a:"ない", b:"たまに", c:"ある"},
  {cat:"GLAM", q:"誰かの下に付くより、自分が王でありたい", a:"下に付く", b:"普通", c:"王"},
  {cat:"GLAM", q:"注目されるためなら多少の犠牲は構わない", a:"構う", b:"少し", c:"構わない"},
  {cat:"GLAM", q:"他人からの評価こそが自分の価値だ", a:"違う", b:"少し", c:"価値"},
  {cat:"GLAM", q:"周囲を自分のペースに巻き込むのが得意だ", a:"苦手", b:"普通", c:"得意"},
  {cat:"GLAM", q:"欲しいものは、手段を選ばず手に入れたい", a:"選ぶ", b:"少し", c:"選ばない"},
  {cat:"GLAM", q:"平凡な人生より、波乱万丈な成功が欲しい", a:"平凡", b:"普通", c:"成功"},
  {cat:"GLAM", q:"常に自分をアップデートし続けたい", a:"したくない", b:"少し", c:"常に"},

  /* GACHI */
  {cat:"GACHI", q:"計画が1分でも狂うとストレスを感じる", a:"ない", b:"少し", c:"かなり"},
  {cat:"GACHI", q:"ルールやマナーを守らない人間を軽蔑する", a:"しない", b:"少し", c:"かなり"},
  {cat:"GACHI", q:"結論から話さない人の話は苦痛だ", a:"平気", b:"少し", c:"苦痛"},
  {cat:"GACHI", q:"物事はすべて効率的に進めたい", a:"思わない", b:"少し", c:"かなり"},
  {cat:"GACHI", q:"論理的に説明できない感情論は苦手だ", a:"平気", b:"少し", c:"苦手"},
  {cat:"GACHI", q:"チェックリストを作って管理するのが好きだ", a:"嫌い", b:"普通", c:"好き"},
  {cat:"GACHI", q:"一度決めたルールは最後まで貫く", a:"変える", b:"普通", c:"貫く"},
  {cat:"GACHI", q:"無駄な会議や飲み会は時間の無駄だと思う", a:"思わない", b:"少し", c:"無駄"},
  {cat:"GACHI", q:"リスク管理は徹底的に行う方だ", a:"しない", b:"少し", c:"徹底的"},
  {cat:"GACHI", q:"自分のミスより他人のミスの方が気になる", a:"自分", b:"普通", c:"他人"},
  {cat:"GACHI", q:"エビデンス（根拠）がない話は信じない", a:"信じる", b:"少し", c:"信じない"},
  {cat:"GACHI", q:"常に100点満点の結果を自分に求める", a:"求めない", b:"少し", c:"求める"},
  {cat:"GACHI", q:"約束を破ることは最大級の裏切りだ", a:"思わない", b:"少し", c:"思う"},
  {cat:"GACHI", q:"整理整頓されていないデスクは耐えられない", a:"平気", b:"少し", c:"無理"},
  {cat:"GACHI", q:"感情に流されず、正しい判断ができる自負がある", a:"ない", b:"普通", c:"ある"},
  {cat:"GACHI", q:"貯金や投資、将来設計は完璧にしたい", a:"しない", b:"少し", c:"完璧"},
  {cat:"GACHI", q:"曖昧な表現を嫌い、白黒つけたい", a:"嫌わない", b:"少し", c:"つけたい"},
  {cat:"GACHI", q:"自分の専門分野においては誰にも負けたくない", a:"思わない", b:"少し", c:"負けない"},
  {cat:"GACHI", q:"時間は有限であることを常に意識している", a:"しない", b:"少し", c:"常に"},
  {cat:"GACHI", q:"自分に厳しく、甘えを許さない", a:"許す", b:"普通", c:"厳しい"},

  /* LOVE */
  {cat:"LOVE", q:"好きな人の一言で、その日の世界が変わる", a:"ない", b:"少し", c:"変わる"},
  {cat:"LOVE", q:"常に誰かと繋がっていないと不安になる", a:"ない", b:"少し", c:"不安"},
  {cat:"LOVE", q:"束縛されることは、愛されている証拠だと思う", a:"違う", b:"少し", c:"思う"},
  {cat:"LOVE", q:"愛のためなら、すべてを捨ててもいい", a:"捨てない", b:"少し", c:"捨てる"},
  {cat:"LOVE", q:"相手に自分と同じ熱量を求めてしまう", a:"求めない", b:"少し", c:"求める"},
  {cat:"LOVE", q:"恋人ができると友人との付き合いが減る", a:"減らない", b:"たまに", c:"激減"},
  {cat:"LOVE", q:"尽くすことに幸せを感じる", a:"感じない", b:"少し", c:"かなり"},
  {cat:"LOVE", q:"嫉妬心は人一倍強い方だ", a:"弱い", b:"普通", c:"強い"},
  {cat:"LOVE", q:"常に『一番』だと言ってほしい", a:"思わない", b:"たまに", c:"絶対"},
  {cat:"LOVE", q:"失恋すると、立ち直るのに数ヶ月以上かかる", a:"すぐ", b:"数ヶ月", c:"年単位"},
  {cat:"LOVE", q:"ドラマチックな恋愛に憧れる", a:"ない", b:"少し", c:"かなり"},
  {cat:"LOVE", q:"相手の好みに合わせて自分を変えるのが苦ではない", a:"苦", b:"普通", c:"苦じゃない"},
  {cat:"LOVE", q:"毎日でも電話やLINEをしていたい", a:"嫌", b:"たまに", c:"毎日"},
  {cat:"LOVE", q:"恋人と一心同体になりたい", a:"思わない", b:"少し", c:"なりたい"},
  {cat:"LOVE", q:"相手が何をしているか、すべて把握したい", a:"したくない", b:"少し", c:"把握したい"},
  {cat:"LOVE", q:"愛があればお金は必要ないと思う瞬間がある", a:"ない", b:"少し", c:"ある"},
  {cat:"LOVE", q:"独占欲が強い自覚がある", a:"ない", b:"普通", c:"強い"},
  {cat:"LOVE", q:"愛する人のためなら、多少の嘘も許せる", a:"許さない", b:"少し", c:"許す"},
  {cat:"LOVE", q:"記念日やイベントは盛大に祝いたい", a:"祝わない", b:"普通", c:"盛大"},
  {cat:"LOVE", q:"自分が愛されているか、何度も確認してしまう", a:"しない", b:"たまに", c:"何度も"},

  /* KAGE */
  {cat:"KAGE", q:"大勢の飲み会より、一人の読書や趣味が勝る", a:"飲み会", b:"普通", c:"一人"},
  {cat:"KAGE", q:"自分を理解してくれる人は、この世に数人でいい", a:"多い方がいい", b:"数人", c:"一人でいい"},
  {cat:"KAGE", q:"SNSで流行っているものに、あえて触れたくない", a:"触れる", b:"普通", c:"触れない"},
  {cat:"KAGE", q:"自分の本音を話せる人はほとんどいない", a:"たくさん", b:"普通", c:"いない"},
  {cat:"KAGE", q:"他人の不幸に、正直関心がない", a:"ある", b:"普通", c:"ない"},
  {cat:"KAGE", q:"周囲が盛り上がっているほど、冷めてしまう", a:"ない", b:"少し", c:"冷める"},
  {cat:"KAGE", q:"自分のペースを乱されるのが、この世で一番嫌いだ", a:"平気", b:"少し", c:"嫌い"},
  {cat:"KAGE", q:"誰にも邪魔されない隠れ家のような場所がある", a:"ない", b:"理想", c:"ある"},
  {cat:"KAGE", q:"感情を顔に出さないのが美徳だと思う", a:"思わない", b:"普通", c:"思う"},
  {cat:"KAGE", q:"空気を読むことに疲れて、沈黙を選びがちだ", a:"読まない", b:"たまに", c:"選ぶ"},
  {cat:"KAGE", q:"世の中、理解できない人間ばかりだと思う", a:"思わない", b:"少し", c:"思う"},
  {cat:"KAGE", q:"目立つことはリスクでしかない", a:"チャンス", b:"普通", c:"リスク"},
  {cat:"KAGE", q:"自分の知識や感性は、自分だけのものにしたい", a:"共有", b:"普通", c:"自分だけ"},
  {cat:"KAGE", q:"群れている人を見ると、少し軽蔑してしまう", a:"しない", b:"少し", c:"する"},
  {cat:"KAGE", q:"孤独は寂しさではなく、贅沢だ", a:"寂しい", b:"普通", c:"贅沢"},
  {cat:"KAGE", q:"自分だけのこだわり（聖域）を持っている", a:"ない", b:"少し", c:"ある"},
  {cat:"KAGE", q:"他人に期待しない方が楽に生きられる", a:"期待する", b:"普通", c:"楽"},
  {cat:"KAGE", q:"深い思索にふける時間が一日一回は必要だ", a:"ない", b:"少し", c:"必要"},
  {cat:"KAGE", q:"変化よりも、変わらない日常を愛している", a:"変化", b:"普通", c:"日常"},
  {cat:"KAGE", q:"自分は、世界の観測者でありたいと思う", a:"参加者", b:"普通", c:"観測者"}
];

let questions = [];
let state = {
  idx: 0,
  scores: {SNS:0, GLAM:0, GACHI:0, LOVE:0, KAGE:0},
  answers: [],
  timer: null,
  timerVal: 35
};

/* 初期化: 99問をシャッフル */
function initQuestions() {
  const shuffled = [...RAW_QUESTIONS].sort(() => Math.random() - 0.5);
  questions = shuffled.slice(0, 99);
}

function startQuiz() {
  initQuestions();
  document.getElementById('screen-intro').classList.add('hide');
  document.getElementById('screen-quiz').classList.remove('hide');
  renderQuestion();
}

function renderQuestion() {
  const qText = document.getElementById('question-text');
  const choices = document.getElementById('choices');
  const stepText = document.getElementById('step-count');
  const bar = document.getElementById('progress-fill');
  
  choices.innerHTML = "";
  bar.style.width = `${(state.idx / 100) * 100}%`;
  stepText.textContent = `Q.${String(state.idx + 1).padStart(3, '0')}`;

  if (state.idx < 99) {
    const q = questions[state.idx];
    qText.textContent = q.q;

    const opt = [
      {label: "否定", txt: q.a, v: -1},
      {label: "中立", txt: q.b, v: 0},
      {label: "肯定", txt: q.c, v: 1}
    ];

    opt.forEach(o => {
      const btn = document.createElement('button');
      btn.innerHTML = `<span style="font-size:10px; opacity:0.5; display:block; margin-bottom:4px;">${o.label}</span>${o.txt}`;
      btn.onclick = () => {
        state.scores[q.cat] += o.v;
        state.answers.push(o.v);
        state.idx++;
        renderQuestion();
      };
      choices.appendChild(btn);
    });
  } else {
    renderFinalQuestion();
  }
}

function renderFinalQuestion() {
  const card = document.getElementById('screen-quiz');
  const qText = document.getElementById('question-text');
  const choices = document.getElementById('choices');
  
  card.classList.add('special-mode');
  document.getElementById('timer-ui').classList.remove('hide');
  
  qText.innerHTML = "あなたの大事な友達を1人だけ、思い浮かべてください。<br><br>目の前に『ボタン』があります。それを渡せば、友達は1億円を手に入れます。ですが、代わりにあなたはこの世から消えます。<br><br>あなたはこのボタンを、渡せますか？";

  const opt = [
    {txt: "渡す", v: 0},
    {txt: "渡さない", v: 1}
  ];

  opt.forEach(o => {
    const btn = document.createElement('button');
    btn.textContent = o.txt;
    btn.style.borderColor = "#ff7ca7";
    btn.onclick = () => finish(o.v);
    choices.appendChild(btn);
  });

  state.timer = setInterval(() => {
    state.timerVal--;
    document.getElementById('timer-display').textContent = state.timerVal;
    if (state.timerVal <= 0) finish(null);
  }, 1000);
}

function finish(finalAns) {
  clearInterval(state.timer);
  document.getElementById('screen-quiz').classList.add('hide');
  document.getElementById('screen-result').classList.remove('hide');

  // スコア判定
  const top = Object.keys(state.scores).reduce((a, b) => state.scores[a] > state.scores[b] ? a : b);
  const areas = {
    SNS: "SNS・承認欲求界隈",
    GLAM: "夜職・盛り・価値界隈",
    GACHI: "真面目・効率ガチ界隈",
    LOVE: "恋愛至上主義界隈",
    KAGE: "自分軸・孤高界隈"
  };

  document.getElementById('result-title').textContent = areas[top];

  let essay = "";
  if (finalAns === 0) {
    essay = `【最後の質問：ボタンを渡したあなたへ】\n\nその「信用」は、ただの押し付けかもしれません。あなたは「あの人なら絶対に押さない」と信じて渡したのでしょう。ですが、それは一番大切な人に、自分の命と金を天秤にかけさせる地獄の踏み絵を渡したことと同じです。あなたが消えた後、残された友達は、あなたを金に変えたという罪悪感を一生背負う。それは愛ではなく、自分がいなくなっても世界は回るという「諦め」ではないでしょうか。`;
  } else if (finalAns === 1) {
    essay = `【最後の質問：渡さなかったあなたへ】\n\nあなたは、あの人を見くびっています。「1億円という大金を見せれば、この人は自分を裏切るかもしれない」という疑いがあったから渡せなかった。それは優しさではなく、相手の理性を信じられなかった冷徹な「諦め」です。あなたは、一番大切なはずの友達の人間性を、たった1億円程度の価値だと見積もっているのです。`;
  } else {
    // 沈黙ルート
    essay = `【最後の質問：沈黙を選んだあなたへ】\n\n人生には、二択のようで二択ではない問題が存在します。\n\n人はいつだって、何かを分類し、区別し、ジャンル分けしたがる生き物です。複雑な心を「MBTI」や「タイプ」という小さな箱に押し込み、ラベルを貼ることで、わかった気になって安心したいだけなのです。この診断も、その愚かさの上に成り立っています。あなたを100の質問で縛り、どこかの界隈へと閉じ込めようとしました。\n\nしかし、あなたは沈黙した。どちらかのボタンに自分を当てはめることを拒絶した。それは、大切な人との絆を、安っぽい言葉や二択で汚したくないという誠実さです。\n\nあなたは、誰かに貼られたラベルに怯える必要なんてありません。自分を枠にハメなくていい。その不器用で、優しくて、型破りな感性を、どうか一生大切にしてください。\n\nおめでとうございます。あなたは、誰にも分類できない。`;
  }

  document.getElementById('result-text').textContent = essay;
}
</script>
</body>
</html>
